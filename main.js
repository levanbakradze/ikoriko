// Product Database - Smart Management System
const productsDatabase = {
    gym: [
        {
            id: 1,
            title: "წოლჭიმის დანადგარი",
            price: "₾350",
            image: "https://images.unsplash.com/photo-1633989464081-16ccd31287a1?q=80&w=2071&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",
            category: "gym",
            link: "products/product-1.html"
        },
        {
            id: 2,
            title: "მულტიფუნქციური ტრენაჟორი",
            price: "₾580",
            image: "https://images.unsplash.com/photo-1517836357463-d25dfeac3438?q=80&w=2070&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",
            category: "gym"
        },
        {
            id: 3,
            title: "ჰანტელების ნაკრები",
            price: "₾250",
            image: "https://images.unsplash.com/photo-1745233710584-332f527ecd0c?q=80&w=2070&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",
            category: "gym"
        },
        {
            id: 4,
            title: "ძალოვანი ღეროები",
            price: "₾180",
            image: "https://images.unsplash.com/photo-1633989464081-16ccd31287a1?q=80&w=2071&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",
            category: "gym"
        },
        {
            id: 5,
            title: "კარდიო ველოსიპედი",
            price: "₾420",
            image: "https://images.unsplash.com/photo-1517836357463-d25dfeac3438?q=80&w=2070&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",
            category: "gym"
        },
        {
            id: 6,
            title: "ფანქრული ღეროები",
            price: "₾300",
            image: "https://images.unsplash.com/photo-1745233710584-332f527ecd0c?q=80&w=2070&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",
            category: "gym"
        },
        {
            id: 7,
            title: "ღია ტრენაჟორი",
            price: "₾380",
            image: "https://images.unsplash.com/photo-1633989464081-16ccd31287a1?q=80&w=2071&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",
            category: "gym"
        },
        {
            id: 8,
            title: "ზურგის ტრენაჟორი",
            price: "₾290",
            image: "https://images.unsplash.com/photo-1517836357463-d25dfeac3438?q=80&w=2070&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",
            category: "gym"
        },
        {
            id: 9,
            title: "ლეგ პრესი",
            price: "₾520",
            image: "https://images.unsplash.com/photo-1745233710584-332f527ecd0c?q=80&w=2070&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",
            category: "gym"
        },
        {
            id: 10,
            title: "ტრენაჟორთა კომპლექსი",
            price: "₾750",
            image: "https://images.unsplash.com/photo-1633989464081-16ccd31287a1?q=80&w=2071&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",
            category: "gym"
        }
    ],
    armwrestling: [
        {
            id: 11,
            title: "მკლავჭიდის მაგიდა",
            price: "₾157",
            image: "https://images.unsplash.com/photo-1517836357463-d25dfeac3438?q=80&w=2070&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",
            category: "armwrestling"
        },
        {
            id: 12,
            title: "მკლავჭიდის სახელური",
            price: "₾360",
            image: "https://images.unsplash.com/photo-1517836357463-d25dfeac3438?q=80&w=2070&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",
            category: "armwrestling"
        },
        {
            id: 13,
            title: "ხელის ღეროები",
            price: "₾120",
            image: "https://images.unsplash.com/photo-1745233710584-332f527ecd0c?q=80&w=2070&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",
            category: "armwrestling"
        },
        {
            id: 14,
            title: "რეგულირებადი მაგიდა",
            price: "₾280",
            image: "https://images.unsplash.com/photo-1633989464081-16ccd31287a1?q=80&w=2071&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",
            category: "armwrestling"
        },
        {
            id: 15,
            title: "ძალის ტრენერი",
            price: "₾440",
            image: "https://images.unsplash.com/photo-1517836357463-d25dfeac3438?q=80&w=2070&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",
            category: "armwrestling"
        },
        {
            id: 16,
            title: "პროფესიონალური მაგიდა",
            price: "₾520",
            image: "https://images.unsplash.com/photo-1745233710584-332f527ecd0c?q=80&w=2070&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",
            category: "armwrestling"
        },
        {
            id: 17,
            title: "ხელის ტრენერი",
            price: "₾190",
            image: "https://images.unsplash.com/photo-1633989464081-16ccd31287a1?q=80&w=2071&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",
            category: "armwrestling"
        },
        {
            id: 18,
            title: "ცხრილის ტრენერი",
            price: "₾340",
            image: "https://images.unsplash.com/photo-1517836357463-d25dfeac3438?q=80&w=2070&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",
            category: "armwrestling"
        },
        {
            id: 19,
            title: "მოძრაობის ტრენერი",
            price: "₾230",
            image: "https://images.unsplash.com/photo-1745233710584-332f527ecd0c?q=80&w=2070&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",
            category: "armwrestling"
        },
        {
            id: 20,
            title: "კომპლექსური ტრენერი",
            price: "₾650",
            image: "https://images.unsplash.com/photo-1633989464081-16ccd31287a1?q=80&w=2071&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",
            category: "armwrestling"
        }
    ],
    accessories: [
        {
            id: 21,
            title: "ხელის ტერფები",
            price: "₾50",
            image: "https://images.unsplash.com/photo-1517836357463-d25dfeac3438?q=80&w=2070&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",
            category: "accessories"
        },
        {
            id: 22,
            title: "დაცვითი ხელთათმანები",
            price: "₾35",
            image: "https://images.unsplash.com/photo-1745233710584-332f527ecd0c?q=80&w=2070&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",
            category: "accessories"
        },
        {
            id: 23,
            title: "ელბოუ პედები",
            price: "₾45",
            image: "https://images.unsplash.com/photo-1633989464081-16ccd31287a1?q=80&w=2071&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",
            category: "accessories"
        },
        {
            id: 24,
            title: "რისტ სტრეპები",
            price: "₾25",
            image: "https://images.unsplash.com/photo-1517836357463-d25dfeac3438?q=80&w=2070&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",
            category: "accessories"
        },
        {
            id: 25,
            title: "მკლავჭიდის ბალიშები",
            price: "₾40",
            image: "https://images.unsplash.com/photo-1745233710584-332f527ecd0c?q=80&w=2070&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",
            category: "accessories"
        },
        {
            id: 26,
            title: "ღრმა ფეხსაცმელები",
            price: "₾80",
            image: "https://images.unsplash.com/photo-1633989464081-16ccd31287a1?q=80&w=2071&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",
            category: "accessories"
        },
        {
            id: 27,
            title: "ტრენინგ ფუტბოლკები",
            price: "₾60",
            image: "https://images.unsplash.com/photo-1517836357463-d25dfeac3438?q=80&w=2070&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",
            category: "accessories"
        },
        {
            id: 28,
            title: "ღემბანის პროტექტორები",
            price: "₾55",
            image: "https://images.unsplash.com/photo-1745233710584-332f527ecd0c?q=80&w=2070&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",
            category: "accessories"
        },
        {
            id: 29,
            title: "მაგნეზიუმის ფხვნილი",
            price: "₾15",
            image: "https://images.unsplash.com/photo-1633989464081-16ccd31287a1?q=80&w=2071&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",
            category: "accessories"
        },
        {
            id: 30,
            title: "აქსესუარების ნაკრები",
            price: "₾120",
            image: "https://images.unsplash.com/photo-1517836357463-d25dfeac3438?q=80&w=2070&auto=format&fit=crop&ixlib=rb-4.1.0&ixid=M3wxMjA3fDB8MHxwaG90by1wYWdlfHx8fGVufDB8fHx8fA%3D%3D",
            category: "accessories"
        }
    ]
};

// Reviews data for mobile carousel
const reviewsData = [
    {
        title: "შესანიშნავი ხარისხი",
        body: "ძალიან კმაყოფილი ვარ შეძენილი პროდუქტით. ხარისხი მაღალია და მუშაობა შესანიშნავია.",
        name: "გიორგი მელაძე",
        date: "15 მაისი 2024"
    },
    {
        title: "რეკომენდირებული",
        body: "მუშაობის ხარისხი ძალიან კარგია, სწრაფი მიწოდება და მომსახურება პროფესიონალურია.",
        name: "ნინო ღუდუშაური",
        date: "3 ივნისი 2024"
    },
    {
        title: "მაღალი ხარისხი",
        body: "ღირებულება და ხარისხი იდეალურად ერთმანეთს ებრძოლება. კმაყოფილი ვარ შეძენით.",
        name: "დავით კოპალაძე",
        date: "28 აპრილი 2024"
    }
];

// Global variables
let currentProducts = [];
let currentCarouselIndex = 0;
let currentPage = 1;
const productsPerPage = 6;

// Mobile menu toggle
function toggleMobileMenu() {
    const mobileMenu = document.getElementById('mobile-menu');
    const burgerMenu = document.querySelector('.burger-menu');
    
    mobileMenu.classList.toggle('active');
    burgerMenu.classList.toggle('active');
}

// Create product card HTML
function createProductCard(product) {
    return `
        <div class="product-card">
            ${product.link ? `<a href="${product.link}">` : ''}
                <img src="${product.image}" alt="${product.title}" class="product-image">
                <h3 class="product-title">${product.title}</h3>
                <p class="product-price">${product.price}</p>
            ${product.link ? `</a>` : ''}
        </div>
    `;
}

// Filter products
function filterProducts(category) {
    // Update filter buttons - only if event exists (not on page load)
    if (window.event) {
        document.querySelectorAll('.filter-btn').forEach(btn => {
            btn.classList.remove('active');
        });
        window.event.target.classList.add('active');
    }

    // Get filtered products
    if (category === 'all') {
        currentProducts = [...productsDatabase.gym, ...productsDatabase.armwrestling, ...productsDatabase.accessories];
    } else {
        currentProducts = productsDatabase[category] || [];
    }

    // Reset pagination
    currentPage = 1;
    currentCarouselIndex = 0;

    // Render products and pagination
    renderProducts();
    renderPagination();
    updateCarouselControls();
}

// Render products for both desktop and mobile
function renderProducts() {
    const desktopGrid = document.getElementById('products-grid');
    const mobileTrack = document.getElementById('products-track');

    // Clear existing products
    desktopGrid.innerHTML = '';
    mobileTrack.innerHTML = '';

    // Desktop: Show paginated products
    const startIndex = (currentPage - 1) * productsPerPage;
    const endIndex = startIndex + productsPerPage;
    const paginatedProducts = currentProducts.slice(startIndex, endIndex);

    paginatedProducts.forEach(product => {
        const productHTML = createProductCard(product);
        desktopGrid.innerHTML += productHTML;
    });

    // Mobile: Show all products in carousel
    currentProducts.forEach(product => {
        const productHTML = createProductCard(product);
        mobileTrack.innerHTML += productHTML;
    });

    // Update mobile carousel position
    updateCarouselPosition();
}

// Render pagination
function renderPagination() {
    const pagination = document.getElementById('pagination');
    const totalPages = Math.ceil(currentProducts.length / productsPerPage);
    
    pagination.innerHTML = '';
    
    if (totalPages <= 1) return;

    // Previous button
    const prevBtn = document.createElement('button');
    prevBtn.className = 'pagination-btn';
    prevBtn.innerHTML = '‹';
    prevBtn.disabled = currentPage === 1;
    prevBtn.onclick = () => goToPage(currentPage - 1);
    pagination.appendChild(prevBtn);

    // Page numbers
    for (let i = 1; i <= totalPages; i++) {
        const pageBtn = document.createElement('button');
        pageBtn.className = `pagination-btn ${i === currentPage ? 'active' : ''}`;
        pageBtn.innerHTML = i;
        pageBtn.onclick = () => goToPage(i);
        pagination.appendChild(pageBtn);
    }

    // Next button
    const nextBtn = document.createElement('button');
    nextBtn.className = 'pagination-btn';
    nextBtn.innerHTML = '›';
    nextBtn.disabled = currentPage === totalPages;
    nextBtn.onclick = () => goToPage(currentPage + 1);
    pagination.appendChild(nextBtn);
}

// Go to specific page
function goToPage(page) {
    const totalPages = Math.ceil(currentProducts.length / productsPerPage);
    
    if (page < 1 || page > totalPages) return;
    
    currentPage = page;
    renderProducts();
    renderPagination();
}

// Mobile carousel navigation
function moveCarousel(direction) {
    const maxIndex = Math.max(0, currentProducts.length - 1);
    
    currentCarouselIndex += direction;
    
    if (currentCarouselIndex < 0) {
        currentCarouselIndex = 0;
    } else if (currentCarouselIndex > maxIndex) {
        currentCarouselIndex = maxIndex;
    }
    
    updateCarouselPosition();
    updateCarouselControls();
}

// Update carousel position
function updateCarouselPosition() {
    const track = document.getElementById('products-track');
    const cardWidth = 220 + 15; // card width + gap
    const translateX = -currentCarouselIndex * cardWidth;
    track.style.transform = `translateX(${translateX}px)`;
}

// Update carousel controls
function updateCarouselControls() {
    const prevBtn = document.getElementById('prev-btn');
    const nextBtn = document.getElementById('next-btn');
    const counter = document.getElementById('carousel-counter');
    
    const maxIndex = Math.max(0, currentProducts.length - 1);
    
    prevBtn.disabled = currentCarouselIndex === 0;
    nextBtn.disabled = currentCarouselIndex >= maxIndex;
    
    counter.textContent = `${currentCarouselIndex + 1} / ${currentProducts.length}`;
}

// Carousel JavaScript for hero section
let slideIndex = 1;
showSlides(slideIndex);

function changeSlide(n) {
    showSlides(slideIndex += n);
}

function currentSlide(n) {
    showSlides(slideIndex = n);
}

function showSlides(n) {
    let slides = document.getElementsByClassName("carousel-slide");
    let dots = document.getElementsByClassName("dot");
    
    if (n > slides.length) {
        slideIndex = 1;
    }
    if (n < 1) {
        slideIndex = slides.length;
    }

    for (let i = 0; i < slides.length; i++) {
        slides[i].classList.remove("active");
    }

    for (let i = 0; i < dots.length; i++) {
        dots[i].classList.remove("active-dot");
    }

    if (slides.length > 0 && slideIndex <= slides.length) {
        slides[slideIndex - 1].classList.add("active");
        dots[slideIndex - 1].classList.add("active-dot");
    }
}

// Initialize the page
document.addEventListener('DOMContentLoaded', function() {
    // Load all products first
    currentProducts = [...productsDatabase.gym, ...productsDatabase.armwrestling, ...productsDatabase.accessories];
    
    // Set "ყველა" button as active
    document.querySelector('.filter-btn[onclick="filterProducts(\'all\')"]').classList.add('active');
    
    // Render products and pagination
    renderProducts();
    renderPagination();
    updateCarouselControls();
    
    // Auto-slide for hero carousel
    setInterval(() => {
        changeSlide(1);
    }, 5000);
    
    // Handle window resize for responsive design
    window.addEventListener('resize', function() {
        updateCarouselPosition();
    });
});
